# issue agentがPRしたWindows用codeが、TDDされていないためハルシネーション検知と修正がされずビルドが通らない #118
[issues #118](https://github.com/cat2151/ym2151-log-play-server/issues/118)

# 何が困るの？
- 開発体験が悪い
  - ほかのprojectの事例
    - PRをいくつか、検証なしで受け入れ
    - 結果、そのまま使える
      - 分析、TDDで品質担保されており、ハルシネーションはほぼない
        - Windows用codeがないマルチプラットフォームprojectなので、agentがTDDしておりcode品質が高い
      - 開発体験が良い
  - このprojectの事例
    - PRをいくつか、検証なしで受け入れ
    - 結果、ビルドが通らない
      - 複数のPRすべてがハルシネーション
      - userが修正時、複数PRのバグが混ざっており切り分けコストがかかる
      - 開発体験が悪い
    - 分析、このprojectのWindows用codeの品質は低い
      - 規模が大きくなってくるにつれ、指数関数的に品質低下が起こっている感触がある
      - ハルシネーションがどんどん増えている

# 対策案
- cargo check target ～gnu
  - WSLで動作確認済み
  - GitHub Copilot Coding Agentでも実施できる可能性がある

# 方法の案
## まずGitHub Actions
- 上記をworkflow作成し、GitHub Actions Linux Runnerで動作確認する
- logでcargo check finished目視確認または、より効率的な確認

# 草稿
- ゴール
    - GitHubのLinux Runner上での GitHub Copilot Coding Agent によるTDDにおいて、以下をPRコメントに書くこと
        - ※大前提。GitHub Linux Runner上での話である。現状、GitHub Copilot Coding Agent はそれしか使えないので。Windows Runnerは使えない。
        - 最低限、Rustのコンパイルチェックで、
            - Windows版コンパイルがエラーとwarningのない状態
            - （code、unit test、統合testすべて）
            - をTDDで実現できるか？
            - その方法は？
                - cargo check target gnuを使う？
                - crossを使う？
                - cargo-xwinを使う？
                - ほかに方法は？
            - agentへのprompt指示だけで実現可能か？
                - そのpromptは？
            - これをweb調査してまとめること
        - もしどうしようもないなら、
            - 一つのPRにつき毎回、userがWindows版の手動ビルドを
                - するしかない？
                - ※今回、3つのPRを「userがWindows版の手動ビルドをせず」受け入れた結果、
                    - 3つともハルシネーションによる認識誤りによるバグや実装漏れがあった
                    - ビルドが通らない、testがfailed、
                        - ビルドを通した以降もバグっている、
                            - という低品質codeだった
                - つまりGitHub Copilot Coding Agentの自律的なactionではどうにもならない？
                    - ※もしCI/CDでGitHub Actionsで、Windows版のコンパイルが通るかチェックしたところで、それをagentが自律的にactionしてTDDで修正できない、というフローなら、手間をかけてやる意味が薄い
                        - それは結局、運用として、userが手動でそれをチェックしてlocalでagentをkickする、がマストになってしまい、userの手間がかかる点では大差ないので
            - これをweb調査してまとめること

# 状況
- 検討中
