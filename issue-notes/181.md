# issue 64回 OPM_Clockを呼ぶ call_opm_clock_64times.cを実装する #181
[issues #181](https://github.com/cat2151/ym2151-log-play-server/issues/181)


- call_opm_clock_64times.c の内容：
    - opm.c をincludeすること（opm.hではない）
    - call_opm_clock_64times 関数を実装すること
- call_opm_clock_64times.c はシングルソースとしてビルドされること
- Rust側の generate_samples からは、その call_opm_clock_64times 関数を呼ぶこと
- 補足。つまりFFI境界が1つ変更となり、OPM_Clock ではなく、 call_opm_clock_64times に変わる
    - これにより1sample処理におけるFFI境界をまたぐ回数を1/64に減らすことができる
- 目的：シングルソースにすることで「コンパイラ最適化不足のリスク」を減らす
    - 高速になるかは不明だが、「低速リスクのある状態」よりベター、という状態にする、ということ
    - 本来はパフォーマンス計測してから行うべきだが、これに限ってはローリスク、ローコストの対策なので、計測するほうがむしろコストが高くつくこともあり、「重たくならなかったことをもってOK」とするつもり
